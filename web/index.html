<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Competetive RetroAchievements</title>
  <link rel="icon" type="image/png" href="favicon.png" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="layout">
    <aside class="presenceBar">
      <h2 class="sectionTitle">Online Now</h2>
      <div id="onlineUsers" class="onlineList"></div>
      <p class="note" id="onlineHint">Active viewers appear here.</p>
    </aside>
    <div class="wrap">
    <div class="panelHeader">
      <div class="panelTitle">
        <h1><span class="titlePrimary">Competetive</span> <span class="titleAccent">RetroAchievements</span></h1>
        <p class="subtitle">Group Leaderboard and Achievement Tracking</p>
      </div>
      <div class="topActions">
        <div class="refreshBlock">
          <div class="refreshRow">
            <button id="settingsBtn" class="smallBtn">Settings</button>
            <button id="refreshBtn" class="smallBtn">Refresh</button>
          </div>
          <span id="refreshCountdown" class="note"></span>
        </div>
      </div>
    </div>
    <div class="pageTabs" role="tablist" aria-label="Pages">
      <button class="pageBtn active" data-page="dashboard" role="tab" aria-selected="true">Dashboard</button>
      <button class="pageBtn" data-page="find-games" role="tab" aria-selected="false">Find Games</button>
      <button class="pageBtn" data-page="challenges" role="tab" aria-selected="false">Challenges</button>
      <button class="pageBtn" data-page="backlog" role="tab" aria-selected="false">My Backlog</button>
      <button class="pageBtn profileTab" data-page="profile" role="tab" aria-selected="false">My Profile</button>
    </div>
    <div class="status" id="status"></div>

    <div id="settingsModal" class="modal" hidden>
      <div class="modalCard">
        <div class="sectionHead">
          <h2 class="sectionTitle">Settings</h2>
          <button id="settingsCloseBtn" class="smallBtn">Close</button>
        </div>
        <div class="field">
          <label for="meInput">Username</label>
          <input id="meInput" placeholder="Your RA username" autocomplete="off" />
        </div>
        <div class="field">
          <label for="apiKeyInput">API key (optional)</label>
          <input id="apiKeyInput" placeholder="Use your own RetroAchievements API key" autocomplete="off" />
        </div>
        <div class="field checkboxField">
          <label class="checkboxLabel">
            <input type="checkbox" id="useApiKeyToggle" />
            Use custom API key
          </label>
        </div>
        <div class="field checkboxField">
          <label class="checkboxLabel">
            <input type="checkbox" id="debugUiToggle" />
            Debug UI
          </label>
        </div>
        <div class="buttons">
          <button id="settingsSaveBtn">Save</button>
          <button id="settingsCancelBtn" class="smallBtn">Cancel</button>
        </div>
      </div>
    </div>

    <div id="addFriendModal" class="modal" hidden>
      <div class="modalCard">
        <div class="sectionHead">
          <h2 class="sectionTitle">Add Friend</h2>
          <button id="addFriendCloseBtn" class="smallBtn">Close</button>
        </div>
      <div class="field">
        <label for="friendInput">Friend username</label>
        <input id="friendInput" placeholder="RetroAchievements username" autocomplete="off" />
      </div>
      <div id="addFriendLoading" class="loadingWheel" hidden aria-label="Loading"></div>
      <div id="addFriendError" class="note errorText" role="alert"></div>
      <div class="buttons">
        <button id="addFriendConfirmBtn">Add</button>
        <button id="addFriendCancelBtn" class="smallBtn">Cancel</button>
        </div>
      </div>
    </div>

    <div id="usernameModal" class="modal" hidden>
      <div class="modalCard">
        <div class="sectionHead">
          <h2 class="sectionTitle">Enter username to continue</h2>
        </div>
        <div class="field">
          <label for="usernameModalInput">Username</label>
          <input id="usernameModalInput" placeholder="Your RA username" autocomplete="off" />
        </div>
        <div class="field">
          <label for="usernameModalApiKeyInput">API key (optional)</label>
          <input id="usernameModalApiKeyInput" placeholder="RetroAchievements API key" autocomplete="off" />
        </div>
        <div class="field checkboxField">
          <label class="checkboxLabel">
            <input type="checkbox" id="usernameModalUseApiKeyToggle" />
            Use custom API key
          </label>
        </div>
        <div id="usernameModalLoading" class="loadingWheel" hidden aria-label="Loading"></div>
        <div id="usernameModalError" class="note errorText" role="alert"></div>
        <div class="buttons">
          <button id="usernameModalConfirmBtn">Continue</button>
        </div>
      </div>
    </div>

    <section id="dashboardPage" class="page active">
    <section class="card">
      <div class="sectionHead">
        <h2 class="sectionTitle" id="leaderboardTitle">Monthly Leaderboard</h2>
        <div class="sectionControls">
          <div class="leaderboardTabs" role="tablist" aria-label="Leaderboard ranges">
            <button class="smallBtn leaderboardTab" data-range="daily" role="tab" aria-selected="false">Daily</button>
            <button class="smallBtn leaderboardTab" data-range="weekly" role="tab" aria-selected="false">Weekly</button>
            <button class="smallBtn leaderboardTab" data-range="monthly" role="tab" aria-selected="true">Monthly</button>
          </div>
          <button id="addFriendOpenBtn" class="smallBtn primaryBtn">Add Friend</button>
          <div id="leaderboardLoading" class="loadingWheel" hidden aria-label="Loading"></div>
        </div>
      </div>
      <div class="leaderboardTableWrap">
        <table id="leaderboard">
        <thead>
          <tr>
            <th>User</th>
            <th>Points</th>
            <th>Gap vs You</th>
            <th>Unlocks</th>
            <th>Now Playing</th>
            <th></th>
          </tr>
        </thead>
        <tbody></tbody>
        </table>
      </div>
      <div class="leaderboardHintWrap">
        <p class="note leaderboardHint">Click name to view profile.</p>
      </div>
      <p class="note" id="leaderboardPointsNote">Points column shows monthly total with today in parentheses.</p>
      <div class="chartCard">
        <div class="chartHeader">
          <h3 class="chartTitle" id="leaderboardChartTitle">Daily Points (Last 7 Days)</h3>
          <div class="chartTabs" role="tablist" aria-label="Points charts">
            <button class="smallBtn chartTab active" data-chart="daily" role="tab" aria-selected="true">Daily</button>
            <button class="smallBtn chartTab" data-chart="hourly" role="tab" aria-selected="false">Hourly</button>
          </div>
        </div>
        <div id="leaderboardChart" class="chartWrap"></div>
        <div id="leaderboardHourlyChart" class="chartWrap" hidden></div>
      </div>
    </section>

    <div id="profileHostDashboard">
    <section class="card profilePanel" id="profilePanel" hidden>
      <div class="sectionHead">
        <h2 class="sectionTitle">Profile: <span id="profileTitleName"></span></h2>
        <div class="profileFilters">
          <input id="profileGameSearch" type="text" placeholder="Search games..." autocomplete="off" />
        </div>
        <div id="profileLoading" class="loadingWheel" hidden aria-label="Loading"></div>
        <button id="profileCloseBtn" class="smallBtn">Close</button>
      </div>
      <div id="profileSummary" class="profileSummary"></div>
      <div id="profileInsights" class="profileInsights"></div>
      <div id="profileSharedGames" class="tileGrid"></div>
      <p class="note" id="profileGamesNote">Shows recently played games you both have in common.</p>
      <div class="profileActions">
        <button id="profileShowMoreBtn" class="smallBtn">Show more</button>
        <button id="profileBacklogBtn" class="smallBtn">Show Backlog</button>
      </div>
      <p class="note profileLegend"><span class="legend star silver">&#9733;</span> <span>Beaten</span> <span class="legend star gold">&#9733;</span> <span>All achievements</span> <span class="legend me"></span> <span id="profileLegendMe">You</span> <span class="legend them"></span> <span id="profileLegendThem">Friend</span></p>
    </section>

    <section class="card comparePanel" id="comparePanel" hidden>
      <div class="sectionHead">
        <h2 class="sectionTitle">Compare: <span id="compareTitleGame"></span></h2>
        <div id="compareLoading" class="loadingWheel" hidden aria-label="Loading"></div>
        <button id="compareBackBtn" class="smallBtn">Back</button>
      </div>
        <div class="tabButtons" role="tablist" aria-label="Compare tabs">
          <button class="compareTabBtn active" data-tab="achievements" role="tab" aria-selected="true" aria-controls="compare-tab-achievements">Achievements</button>
        <button class="compareTabBtn" data-tab="times" role="tab" aria-selected="false" aria-controls="compare-tab-times">Scores</button>
        </div>
      <div id="compareMeta" class="meta"></div>
      <div id="compare-tab-achievements" class="compareTabPanel active" role="tabpanel">
        <div id="compareAchievements" class="compareList"></div>
      </div>
      <div id="compare-tab-times" class="compareTabPanel" role="tabpanel">
        <div id="compareTimes" class="compareTimesList"></div>
      </div>
      <p class="note">Shared achievements are listed first.</p>
    </section>
    </div>

    <div id="selfGameHostDashboard">
    <section class="card selfGamePanel" id="selfGamePanel" hidden>
      <div class="sectionHead">
        <h2 class="sectionTitle">Game: <span id="selfGameTitle"></span></h2>
        <button id="selfGameBackBtn" class="smallBtn">Back</button>
      </div>
      <div id="selfGameMeta" class="meta"></div>
      <div id="selfGameAchievements" class="compareList"></div>
      <p class="note">Your achievements for this game.</p>
    </section>
    </div>

    <section class="card tabsCard">
      <div class="tabsHead">
        <h2 class="sectionTitle">Friends activity</h2>
        <div class="tabButtons" role="tablist" aria-label="Recent activity tabs">
          <button class="tabBtn active" data-tab="achievements" role="tab" aria-selected="true" aria-controls="tab-achievements">Recent Achievements</button>
          <button class="tabBtn" data-tab="times" role="tab" aria-selected="false" aria-controls="tab-times">Recent Scores</button>
        </div>
      </div>

      <div id="tab-achievements" class="tabPanel active" role="tabpanel">
        <div class="sectionHead">
          <h2 class="sectionTitle">Recent Achievements</h2>
          <div class="sectionControls"></div>
        </div>
        <div id="recentAchievements" class="feed"></div>
        <div class="feedActions">
          <button id="recentAchievementsShowLessBtn" class="smallBtn" hidden>Show less</button>
          <button id="recentAchievementsToggleBtn" class="smallBtn" hidden>Show more</button>
        </div>
        <div id="recentAchievementsLoading" class="loadingWheel" hidden aria-label="Loading"></div>
      </div>

      <div id="tab-times" class="tabPanel" role="tabpanel">
        <div class="sectionHead">
          <h2 class="sectionTitle">Recent Scores</h2>
          <div class="sectionControls">
            <label class="tiny">
              Recently played games
              <input id="recentGames" type="number" min="1" max="200" value="5" />
            </label>
          </div>
        </div>
        <div id="recentTimes" class="feed"></div>
        <p class="note">Derived from recently played games + user game leaderboards.</p>
        <div class="feedActions">
          <button id="recentTimesToggleBtn" class="smallBtn" hidden>Show more</button>
        </div>
        <div id="recentTimesLoading" class="loadingWheel" hidden aria-label="Loading"></div>
      </div>
    </section>
    </section>
    <section id="findGamesPage" class="page" hidden>
      <section class="card">
        <div class="sectionHead">
          <h2 class="sectionTitle">Find Games</h2>
          <div class="sectionControls">
            <div id="findGamesLoading" class="loadingWheel" hidden aria-label="Loading"></div>
          </div>
        </div>
        <div class="findGamesTabs tabButtons" role="tablist" aria-label="Find games tabs">
          <button class="tabBtn active" data-find-tab="search" role="tab" aria-selected="true">Search Games</button>
          <button class="tabBtn" data-find-tab="suggested" role="tab" aria-selected="false">Games You Might Be Interested In</button>
        </div>
        <div id="findTabSearch" class="findGamesTabPanel active" role="tabpanel">
          <div id="findSearchListPanel">
            <div class="findGamesControls">
              <label for="findGamesConsole" class="tiny">Console</label>
              <select id="findGamesConsole" class="mutedSelect"></select>
              <label for="findGamesSearch" class="tiny">Search</label>
              <input id="findGamesSearch" type="text" placeholder="Search games..." autocomplete="off" />
            </div>
            <div id="gameLetterBar" class="letterBar" role="tablist" aria-label="Game letters"></div>
            <div id="findGamesList" class="findGamesList findGamesGrid"></div>
          </div>
          <div id="findSearchAchievementsPanel" class="findGamesAchievementsPanel" hidden>
            <div class="sectionHead">
              <h3 class="sectionTitle">Achievements</h3>
              <button id="findSearchBackBtn" class="smallBtn">Back</button>
            </div>
            <div id="findGamesAchievements" class="findGamesAchievements"></div>
          </div>
        </div>
        <div id="findTabSuggested" class="findGamesTabPanel" role="tabpanel" hidden>
          <div id="findSuggestedListPanel">
            <div class="sectionHead compact">
              <h3 class="sectionTitle">Series-based picks</h3>
              <div id="findSuggestedLoading" class="loadingWheel" hidden aria-label="Loading"></div>
            </div>
            <p id="findSuggestedStatus" class="note"></p>
            <div id="findSuggestedList" class="tileGrid findGamesGrid"></div>
          </div>
          <div id="findSuggestedAchievementsPanel" class="findGamesAchievementsPanel" hidden>
            <div class="sectionHead">
              <h3 class="sectionTitle">Achievements</h3>
              <button id="findSuggestedBackBtn" class="smallBtn">Back</button>
            </div>
            <div id="findSuggestedAchievements" class="findGamesAchievements"></div>
          </div>
        </div>
      </section>
    </section>
    <section id="profilePage" class="page" hidden>
      <div id="profileHostProfile"></div>
      <div id="selfGameHostProfile"></div>
    </section>
    <section id="backlogPage" class="page" hidden>
      <section class="card">
        <div class="sectionHead">
          <h2 class="sectionTitle">My Backlog</h2>
          <div class="sectionControls">
            <div id="backlogLoading" class="loadingWheel" hidden aria-label="Loading"></div>
          </div>
        </div>
        <p id="backlogStatus" class="note"></p>
        <div id="backlogList" class="backlogList"></div>
      </section>
    </section>

    <section id="challengesPage" class="page" hidden>
      <section class="card">
        <div class="sectionHead">
          <h2 class="sectionTitle">Challenges</h2>
          <div class="sectionControls">
            <div id="challengesLoading" class="loadingWheel" hidden aria-label="Loading"></div>
          </div>
        </div>
        <div class="challengeLayout">
          <div class="challengeSidebar">
            <div class="challengeForm">
            <div class="field">
              <label for="challengeOpponent">Friend</label>
              <select id="challengeOpponent"></select>
            </div>
            <div class="field">
              <label for="challengeType">Challenge type</label>
              <select id="challengeType" class="mutedSelect">
                <option value="points">Points Race</option>
                <option value="score">Score Attack</option>
              </select>
            </div>
            <div class="buttons">
              <button id="challengeScoreSelectBtn" class="smallBtn" hidden>Select Game &amp; Score</button>
            </div>
            <div id="challengeScoreSummary" class="note"></div>
            <div class="field">
              <label for="challengeDuration">Duration (hours)</label>
              <input id="challengeDuration" type="number" min="1" max="168" value="24" />
            </div>
            <div class="buttons">
              <button id="challengeSendBtn">Send Challenge</button>
            </div>
            <div id="challengeError" class="note errorText" role="alert"></div>
            </div>
            <div class="challengeHistoryWrap">
              <button id="challengePendingBtn" class="smallBtn">Pending Challenges</button>
              <button id="challengeHistoryBtn" class="smallBtn">Challenge History</button>
            </div>
          </div>

          <div class="challengeLists">
            <div class="challengeBlock">
              <h3 class="sectionTitle">Active Challenges</h3>
              <div id="challengeActive" class="challengeList"></div>
            </div>
          </div>
        </div>
      </section>
    </section>
    <div id="challengeHistoryModal" class="modal" hidden>
      <div class="modalCard">
        <div class="sectionHead">
          <h2 class="sectionTitle">Challenge History</h2>
          <button id="challengeHistoryCloseBtn" class="smallBtn">Close</button>
        </div>
        <div id="challengeHistoryList" class="challengeList"></div>
      </div>
    </div>
    <div id="challengePendingModal" class="modal" hidden>
      <div class="modalCard">
        <div class="sectionHead">
          <h2 class="sectionTitle">Pending Challenges</h2>
          <button id="challengePendingCloseBtn" class="smallBtn">Close</button>
        </div>
        <div class="challengeBlock">
          <h3 class="sectionTitle">Pending Challenges (To You)</h3>
          <div id="challengeIncoming" class="challengeList"></div>
        </div>
        <div class="challengeBlock">
          <h3 class="sectionTitle">Pending Challenges (Sent)</h3>
          <div id="challengeOutgoing" class="challengeList"></div>
        </div>
      </div>
    </div>
    <div id="challengeScoreModal" class="modal" hidden>
      <div class="modalCard modalWide">
        <div class="sectionHead">
          <h2 class="sectionTitle">Score Attack Setup</h2>
          <button id="challengeScoreCloseBtn" class="smallBtn">Close</button>
        </div>
        <div class="scoreAttackLayout">
          <div class="scoreAttackGames">
            <div class="sectionHead compact">
              <h3 class="sectionTitle" id="scoreAttackGamesTitle">Shared Games</h3>
              <div class="scoreAttackControls">
                <div class="scoreAttackTabs">
                  <button class="smallBtn scoreAttackTabBtn active" data-view="shared">Shared</button>
                  <button class="smallBtn scoreAttackTabBtn" data-view="mine">You</button>
                  <button class="smallBtn scoreAttackTabBtn" data-view="theirs">Friend</button>
                </div>
                <button id="scoreAttackShowMoreBtn" class="smallBtn">Show more</button>
              </div>
            </div>
            <div class="field compactField">
              <input id="scoreAttackGamesSearch" placeholder="Search games..." autocomplete="off" />
            </div>
            <div id="scoreAttackGamesList" class="tileGrid scoreAttackGamesList"></div>
          </div>
          <div class="scoreAttackBoards">
            <div class="sectionHead compact">
              <h3 class="sectionTitle">Leaderboards</h3>
            </div>
            <div class="field compactField">
              <input id="scoreAttackBoardsSearch" placeholder="Search leaderboards..." autocomplete="off" />
            </div>
            <div id="scoreAttackBoardsList" class="challengeList scoreAttackBoardsList"></div>
          </div>
        </div>
        <div id="scoreAttackSelection" class="note"></div>
      </div>
    </div>
    <div id="imageModal" class="modal" hidden>
      <div class="modalCard imageModalCard">
        <div class="sectionHead">
          <h2 class="sectionTitle">Image Preview</h2>
          <button id="imageModalCloseBtn" class="smallBtn">Close</button>
        </div>
        <img id="imageModalImg" class="imageModalImg" alt="Preview" />
      </div>
    </div>
    <div id="apiQueueLog" class="apiQueueLog debugHidden" aria-live="polite" hidden>
      <div class="apiQueueLogHeader">
        <div class="apiQueueLogTitle">Logs</div>
        <div class="apiQueueTabs">
          <button class="apiQueueTab active" type="button" data-log="queue">Queue</button>
          <button class="apiQueueTab" type="button" data-log="system">System</button>
        </div>
      </div>
      <div id="apiQueueLogEntries" class="apiQueueLogEntries" data-log-panel="queue"></div>
      <div id="systemLogEntries" class="apiQueueLogEntries" data-log-panel="system" hidden></div>
    </div>
    <div id="apiQueueCounter" class="apiQueueCounter debugHidden" aria-live="polite" hidden></div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
